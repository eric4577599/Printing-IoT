# 現場領班操作手冊 (Field Supervisor Operation Manual)

本手冊專供現場領班與管理人員使用，涵蓋產品資料維護、生產排程管理、即時監控操作、異常排除 SOP 及保養系統管理等進階功能。

---

## 1. 產品資料與訂單管理 (Product & Order Management)

此模組位於 **「排程管理」** 頁面。左側為生產排程，右側為產品資料庫。

### 1.1 新增產品 (Add Product)
1.  點擊右側上方的 **「+ 新增」** 按鈕。
2.  在彈出的視窗中輸入：
    *   **紙箱編號 (Box No)**: 必填，工廠內部編號。
    *   **客戶名稱 (Customer)**: 必填。
    *   **品名 (Product Name)**: 產品描述。
    *   **盒型/楞別/厚度**: 選擇對應規格，系統會自動計算厚度。
    *   **尺寸參數**: 輸入 L/W/H 及展開尺寸 (PX1~PX5, 壓線等)。
    *   **印刷設定**: 設定各印刷單元的印墨與位置。
3.  按 **「確定 (Save)」** 儲存。

### 1.2 修改產品 (Edit Product)
1.  在右側列表中，點選要修改的產品（底色變深）。
2.  點擊右側上方的 **「修改」** 按鈕。
3.  更新資訊後，按 **「確定」** 儲存。

### 1.3 刪除產品 (Delete Product)
1.  在右側列表選取產品。
2.  點擊列表上方的 **「刪除」** 按鈕。
3.  系統會詢問確認。**注意：** 若該產品已有歷史生產紀錄，建議保留資料而非刪除。

### 1.4 新增訂單 (Add Order)
1.  先在右側列表選取要生產的 **產品**。
2.  點擊中間的 **「新增排程」** (綠色按鈕)。
3.  輸入 **訂單號碼 (Order No)** 與 **目標數量 (Qty)**。
4.  按 **「加入排程」**，該工單會出現在左側排程列表最下方。

### 1.5 刪除排程 (Delete Schedule)
1.  在左側排程列表選取工單。
2.  點擊中間的 **「刪除排程」** (紅色按鈕)。
3.  **注意：** 若刪除的是 **正在生產中 (Running)** 的工單（第一筆），系統會檢查車速是否為 0。
    *   若車速 > 0，禁止刪除。
    *   若車速 = 0，需二次確認。

---

## 2. 即時監控與操作 (Real-time Monitor & Operation)

位於 **「即時監控」** 頁面。

### 2.1 功能鍵總覽 (F1 ~ F12)
領班需熟悉以下快捷鍵以指導操作員：

| 按鍵 | 功能名稱 | 說明 |
| :--- | :--- | :--- |
| **F1** | 上移排程 | 將佇列中的下一筆工單優先順序提高。 |
| **F2** | 下移排程 | 將工單順序延後。 |
| **F3** | **開始生產** | 鎖定當前工單，開始計數。生產區轉為綠色。 |
| **F4** | **完工結算** | 結束目前工單，將數據寫入資料庫，並切換至下一筆。 |
| **F7** | **工單明細** | **(領班常用)** 彈出視窗顯示目前工單的**紙箱展開圖**與詳細尺寸，供首件檢查核對。 |
| **F8** | 異常回報 | 快速回報停機或品質異常。 |
| **F10** | **退回/取消** | 將生產中的工單「退回」至待生產列表（用於誤按開始或機台故障換單）。 |

### 2.2 機台狀態燈號
監控畫面右上角或車速旁的燈號代表意義：
*   🟢 **綠燈 (Run)**: 機台運轉中，連線正常。
*   🔴 **紅燈 (Stop/Error)**: 機台停機或發生故障。
*   ⚪ **灰燈 (Offline)**: **通訊中斷** (請參閱第 3 章 SOP)。

### 2.3 停車原因登錄
當機台停機超過 3 分鐘（系統可設定），系統會跳出 **「停機原因選擇」** 視窗。
1.  若未自動跳出，可手動點擊 F8。
2.  選擇類別（如：待料、機械故障、換版、吃飯）。
3.  確認後，該段停機時間會被歸類統計，用於計算稼動率 (OEE)。

---

## 3. 機台連線故障排除 SOP (Connection Troubleshooting)

當監控畫面數據不跳動，或右上角顯示 **「斷線 (Disconnected)」** 時，請依序檢查：

### 步驟 1: 檢查 PLC 狀態
*   確認機台 PLC 電源是否開啟。
*   確認 PLC 網路線插孔燈號是否恆亮或閃爍（橘/綠燈）。

### 步驟 2: 檢查網路連線
*   確認工廠內網 (Wi-Fi/LAN) 是否正常。
*   嘗試在瀏覽器重新整理頁面 (F5)。

### 步驟 3: 檢查後端服務 (Backend Worker)
*   若頁面可開啟但數據皆為 0：
    1.  聯繫 IT 人員或透過 Admin 權限進入 Docker 管理介面。
    2.  檢查 `backend-worker` 容器是否執行中。
    3.  查看日誌：確認是否有 `MQTT Connection Failed` 或 `Modbus Timeout` 錯誤。

### 步驟 4: 系統重啟 (最後手段)
若上述無效，請依序重啟：
1.  關閉瀏覽器分頁。
2.  重啟工控電腦 (IPC)。
3.  待電腦開機完成後，重新執行 Desktop 上的 **"Start Flexo System"** 捷徑。

---

## 4. 生產報表管理 (Reports Management)

領班需負責定期審閱生產報表，確保數據準確並分析異常。

### 4.1 報表類型與用途
*   **生產日報表 (Daily Report)**: 每日下班前確認。重點檢查「良率」與「總產量」是否達標。
*   **生產月報表 (Monthly Report)**: 每月初匯出，用於計算績效獎金與產能檢討。
*   **停車原因分析 (Stop Logs)**: **(重點)** 檢查操作員是否如實填寫停機原因。若發現大量「其他」或未填寫的項目，需進行指導。

### 4.2 匯出與審核
1.  進入 **「生產報表」** 頁面。
2.  選擇日期範圍與班別。
3.  預覽數據無誤後，點擊 **「匯出 Excel」**。
4.  存檔命名建議：`YYYYMMDD_班別_生產日報.xlsx`。

---

## 5. 生產分析與改善 (Production Analysis)

利用數據驅動決策，優化產線效能。

### 5.1 OEE 分析 (稼動率)
進入 **「生產分析」** 頁面，檢視 OEE 趨勢圖。
*   **時間稼動率 (Availability)**: 若過低，代表停機時間太長。需檢討「準備時間」或「故障排除效率」。
*   **性能稼動率 (Performance)**: 若過低，代表平均車速慢。需檢查是否為設備老化或操作員不敢開快。
*   **良品率 (Quality)**: 若過低，需追查特定紙質或盒型的生產參數。

### 5.2 準備時間監控
系統會自動記錄每筆工單之間的「閒置時間」(Gap)。
領班應關注 **「平均換單時間」**，若超過標準值 (例如 15 分鐘)，應介入了解原因。

---

## 6. 保養維修系統 (Maintenance System)

此模組位於 **「保養維修」** 頁面，包含庫存、排程與履歷。

### 6.1 設定保養排程 (Scheduling)
1.  點選 **「⏰ 保養排程」** 頁籤。
2.  設定新排程：
    *   **名稱**: 如 "每週上油"。
    *   **週期**: 選擇 "週 (Week)" 或 "月 (Month)"。
    *   **零件**: 若需更換零件，選擇對應備品（將自動扣庫存）。
3.  儲存後，系統會依週期自動產生待辦任務至「維修清單」。

### 6.2 登錄維修 (Execution)
1.  前往 **「📋 維修清單」**。
2.  看到亮紅燈(逾期)或黃燈(到期)的項目。
3.  點擊 **「執行」**。
4.  (選填) 上傳更換後的照片或備註異常狀況。
5.  確認提交。系統會扣除庫存並轉入歷史履歷。

### 6.3 歷史查詢 (History Query)
1.  點選 **「📜 歷史紀錄」** 頁籤。
2.  列表顯示所有已完成的維修單。
3.  可用關鍵字搜尋（如人員姓名、零件名稱）。
4.  點擊單筆紀錄可查看當時的備註與照片 (View logs)。
