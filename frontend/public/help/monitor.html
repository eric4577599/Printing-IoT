<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å³æ™‚ç›£æ§æ“ä½œèªªæ˜ - Flexo IoT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            padding: 30px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 40px;
        }

        h1 {
            color: #1976d2;
            font-size: 2rem;
            border-bottom: 3px solid #1976d2;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            color: #1565c0;
            font-size: 1.4rem;
            margin: 25px 0 15px;
            padding-left: 12px;
            border-left: 4px solid #42a5f5;
        }

        h3 {
            color: #1e88e5;
            font-size: 1.1rem;
            margin: 15px 0 10px;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .intro {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .fkey-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .fkey-table th {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }

        .fkey-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .fkey-table tr:nth-child(even) {
            background-color: #f5f5f5;
        }

        .fkey-table tr:hover {
            background-color: #e3f2fd;
        }

        .key-badge {
            display: inline-block;
            background: linear-gradient(135deg, #42a5f5 0%, #1976d2 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-family: monospace;
            min-width: 50px;
            text-align: center;
        }

        .key-badge.pink {
            background: linear-gradient(135deg, #f48fb1 0%, #e91e63 100%);
        }

        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }

        .step-list li {
            counter-increment: step-counter;
            padding: 15px 15px 15px 60px;
            margin: 10px 0;
            background: #fafafa;
            border-radius: 8px;
            position: relative;
            border-left: 3px solid #42a5f5;
        }

        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .note {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .note::before {
            content: "ğŸ’¡ æç¤ºï¼š";
            font-weight: bold;
            color: #e65100;
        }

        .warning {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .warning::before {
            content: "âš ï¸ æ³¨æ„ï¼š";
            font-weight: bold;
            color: #c62828;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 500;
        }

        .status-green {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-yellow {
            background: #fff8e1;
            color: #f57f17;
        }

        .status-red {
            background: #ffebee;
            color: #c62828;
        }

        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .color-dot.green {
            background: #4caf50;
        }

        .color-dot.yellow {
            background: #ffc107;
        }

        .color-dot.red {
            background: #f44336;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ–¥ï¸ å³æ™‚ç›£æ§æ“ä½œèªªæ˜ (Monitor Dashboard)</h1>

        <div class="intro">
            <p><strong>å³æ™‚ç›£æ§</strong> æ˜¯æ‚¨æ—¥å¸¸å·¥ä½œçš„æ ¸å¿ƒä»‹é¢ã€‚ä»¥ä¸‹ç‚ºå„€è¡¨æ¿ä¸Šå„å€‹å€å¡Šçš„è©³ç´°åŠŸèƒ½èªªæ˜ï¼š</p>
            <ol class="step-list" style="margin-top: 20px;">
                <li><strong>ç­åˆ¥è³‡è¨Š (Shift Info)</strong>ï¼šé¡¯ç¤ºç›®å‰å€¼ç­çš„ç­åˆ¥ï¼ˆæ—¥ç­/å¤œç­ï¼‰èˆ‡æ™‚æ®µï¼Œç¢ºä¿ç”Ÿç”¢è¨˜éŒ„æ­¸å±¬æ­£ç¢ºã€‚</li>
                <li><strong>æ“ä½œå“¡ (Operator)</strong>ï¼šé¡¯ç¤ºç™»å…¥è€…å§“åã€‚æ‰€æœ‰ç”Ÿç”¢å±¥æ­·èˆ‡ç•°å¸¸å›å ±çš†æœƒè¨˜éŒ„æ­¤äººå“¡ã€‚</li>
                <li><strong>é€£ç·šç‹€æ…‹ (Connection)</strong>ï¼šå³ä¸Šè§’é¡¯ç¤º PLC é€£ç·šç‡ˆè™Ÿã€‚ç¶ ç‡ˆä»£è¡¨é€šè¨Šæ­£å¸¸ï¼Œç´…ç‡ˆä»£è¡¨æ–·ç·šã€‚</li>
                <li><strong>ç›®å‰è»Šé€Ÿ (Line Speed)</strong>ï¼šé¡¯ç¤ºæ©Ÿå°å³æ™‚é‹è½‰é€Ÿåº¦ (m/min)ã€‚æ•¸å€¼é¡è‰²æœƒéš¨é€Ÿåº¦è®ŠåŒ–ï¼ˆç´…/é»ƒ/ç¶ ï¼‰ã€‚</li>
                <li><strong>ç”Ÿç”¢è¨ˆæ•¸ (Current Qty)</strong>ï¼šç›®å‰å·¥å–®å·²ç”Ÿç”¢çš„æ•¸é‡ã€‚ç³»çµ±æœƒè‡ªå‹•æ‰£é™¤åˆå§‹å€¼ (Auto-Tare)ã€‚</li>
                <li><strong>ç›®æ¨™æ•¸é‡ (Target Qty)</strong>ï¼šå·¥å–®é è¨ˆç”Ÿç”¢ç¸½é‡ã€‚ç•¶ç”Ÿç”¢è¨ˆæ•¸é”åˆ°æ­¤æ•¸å€¼ï¼Œæ©Ÿå°æœƒè‡ªå‹•åœæ©Ÿæˆ–æç¤ºã€‚</li>
                <li><strong>ç¶ è‰²ç”Ÿç”¢å€ (Active Zone)</strong>ï¼šç•«é¢ä¸­å¤®ç¶ è‰²èƒŒæ™¯å€åŸŸï¼Œé¡¯ç¤ºã€Œæ­£åœ¨ç”Ÿç”¢ä¸­ã€çš„å·¥å–®è³‡è¨Šã€‚</li>
                <li><strong>é»ƒè‰²æ’ç¨‹å€ (Queue Zone)</strong>ï¼šä¸‹æ–¹åˆ—è¡¨é¡¯ç¤ºã€Œå³å°‡ç”Ÿç”¢ã€çš„å·¥å–®ã€‚å¯é€é F1/F2 èª¿æ•´é †åºã€‚</li>
                <li><strong>æ›å–®è¨ˆæ™‚ (Changeover Timer)</strong>ï¼šç¶ è‰²ç”Ÿç”¢å€é‚Šæ¡†é¡è‰²ä»£è¡¨æ›å–®æ•ˆç‡ã€‚ç¶ è‰²=å¿«ï¼Œç´…è‰²=æ…¢ã€‚</li>
                <li><strong>ç•°å¸¸è·‘é¦¬ç‡ˆ (Alert Bar)</strong>ï¼šé ‚éƒ¨ç´…è‰²å€åŸŸé¡¯ç¤ºæ©Ÿå°ç•°å¸¸è¨Šæ¯ï¼ˆå¦‚ï¼šæ€¥åœã€é¦¬é”éè¼‰ï¼‰ã€‚</li>
                <li><strong>åŠŸèƒ½éµåˆ— (F-Key Bar)</strong>ï¼šåº•éƒ¨é»‘è‰²å€åŸŸå°æ‡‰éµç›¤ F1~F12 åŠŸèƒ½éµï¼Œæä¾›å¿«é€Ÿæ“ä½œæŒ‡å¼•ã€‚</li>
                <li><strong>ç³»çµ±æ™‚é–“ (System Time)</strong>ï¼šé¡¯ç¤ºç›®å‰ä¼ºæœå™¨æ™‚é–“ï¼Œæ‰€æœ‰ç”Ÿç”¢å ±è¡¨ä»¥æ­¤æ™‚é–“ç‚ºæº–ã€‚</li>
            </ol>
        </div>

        <h2>ä¸€ã€ç™»å…¥ç³»çµ±</h2>
        <ol class="step-list">
            <li>ç³»çµ±å•Ÿå‹•å¾Œï¼Œè«‹å…ˆç¢ºèªç•«é¢é¡¯ç¤º<strong>ç™»å…¥è¦–çª—</strong>ã€‚</li>
            <li>é»é¸æ‚¨çš„<strong>ç­åˆ¥</strong>ï¼ˆæ—¥ç­/å¤œç­ï¼‰ã€‚</li>
            <li>åœ¨æ¸…å–®ä¸­æ‰¾åˆ°æ‚¨çš„<strong>äººå“¡ä»£è™Ÿ</strong>ä¸¦é»é¸ã€‚</li>
            <li>æŒ‰ä¸‹<strong>ã€é¸å–ã€‘</strong>å³å¯é€²å…¥ä¸»ç•«é¢ã€‚</li>
        </ol>

        <h2>äºŒã€åŠŸèƒ½éµæ“ä½œ (F-Keys)</h2>
        <div class="intro">
            <p>ç•«é¢æœ€ä¸‹æ–¹çš„é»‘è‰²æŒ‰éˆ•å€å°æ‡‰éµç›¤ä¸Šçš„ F1 ~ F12 éµã€‚ä»¥ä¸‹ç‚ºå„åŠŸèƒ½éµçš„è©³ç´°æ“ä½œèªªæ˜ï¼š</p>

            <h3 style="margin-top: 20px;">F1 / F2ï¼šæ’ç¨‹å„ªå…ˆé †åºèª¿æ•´</h3>
            <p>
                ç•¶ç”Ÿç”¢æ’ç¨‹éœ€è¦è®Šæ›´æ™‚ï¼Œè«‹å…ˆé»é¸ä¸‹æ–¹ä½‡åˆ—ä¸­çš„ç›®æ¨™å·¥å–®ã€‚
                æŒ‰ä¸€ä¸‹ <strong>F1 (ä¸Šç§»)</strong> å¯å°‡è©²å·¥å–®çš„å„ªå…ˆé †åºæé«˜ä¸€ä½ï¼ˆå¾€ä¸Šç§»å‹•ï¼‰ï¼›
                æŒ‰ä¸€ä¸‹ <strong>F2 (ä¸‹ç§»)</strong> å‰‡å°‡å…¶å»¶å¾Œä¸€ä½ã€‚æ­¤åŠŸèƒ½åƒ…é©ç”¨æ–¼ã€Œé»ƒè‰²æ’ç¨‹å€ã€çš„ç­‰å¾…ä¸­å·¥å–®ã€‚
            </p>

            <h3>F3ï¼šé–‹å§‹ç”Ÿç”¢ (Start Production)</h3>
            <p>
                ç•¶æ‚¨æº–å‚™å¥½é–‹å§‹ä¸‹ä¸€ç­†å·¥å–®æ™‚ï¼Œè«‹ç¢ºèªæ©Ÿå°å·²å®Œæˆæ›å–®æº–å‚™ã€‚
                é¸å–ç›®æ¨™å·¥å–®å¾ŒæŒ‰ä¸‹ <strong>F3</strong>ï¼Œç³»çµ±æœƒå°‡è©²å·¥å–®é–å®šä¸¦ç§»å…¥ã€Œç¶ è‰²ç”Ÿç”¢å€ã€ï¼Œæ­¤æ™‚æ©Ÿå°é–‹å§‹è¨ˆæ•¸ï¼Œä¸”ç„¡æ³•å†ç§»å‹•è©²å·¥å–®é †åºã€‚
            </p>

            <h3>F4ï¼šå®Œå·¥çµç®— (Job Complete)</h3>
            <p>
                ç•¶ç”Ÿç”¢é”åˆ°ç›®æ¨™æ•¸é‡æˆ–å·¥å–®çµæŸæ™‚ï¼Œè«‹å‹™å¿…æŒ‰ä¸‹ <strong>F4</strong>ã€‚
                ç³»çµ±æœƒåŸ·è¡Œä»¥ä¸‹å‹•ä½œï¼š1. å°‡ç›®å‰çš„ç”Ÿç”¢æ•¸æ“šï¼ˆæ•¸é‡ã€å¹³å‡è»Šé€Ÿï¼‰å¯«å…¥è³‡æ–™åº«å­˜æª”ï¼›2. æ¸…é™¤ç”Ÿç”¢å€è³‡è¨Šï¼›3. è‹¥é–‹å•Ÿè‡ªå‹•æ›å–®ï¼Œå°‡è‡ªå‹•è¼‰å…¥ä¸‹ä¸€ç­†å·¥å–®ã€‚
            </p>

            <h3>F7ï¼šå·¥å–®æ˜ç´°èˆ‡å±•é–‹åœ– (Details)</h3>
            <p>
                é ˜ç­æˆ–æ“ä½œå“¡å¯éš¨æ™‚æŒ‰ä¸‹ <strong>F7</strong> å½ˆå‡ºè©³ç´°è¦–çª—ã€‚
                è¦–çª—å…§å°‡é¡¯ç¤ºè©²å·¥å–®å°æ‡‰çš„ç´™ç®±<strong>å¹³é¢å±•é–‹åœ– (Box Diagram)</strong>ï¼ŒåŒ…å«é•·å¯¬é«˜ã€å£“ç·šä½ç½®èˆ‡å°åˆ·è¨­å®šï¼Œä¾›é¦–ä»¶èˆ‡è£½ç¨‹ä¸­è‡ªä¸»æª¢æŸ¥å°ç…§ä½¿ç”¨ã€‚
            </p>

            <h3>M / Nï¼šè‡ªå‹•æ›å–®æ¨¡å¼ (Auto Mode)</h3>
            <p>
                ä½æ–¼åŠŸèƒ½åˆ—å³å´çš„é–‹é—œã€‚å•Ÿå‹• <strong>è‡ªå‹•æ¨¡å¼</strong> å¾Œï¼Œç•¶æ‚¨æŒ‰ä¸‹ F4 çµç®—å®Œå·¥æ™‚ï¼Œ
                ç³»çµ±æœƒè‡ªå‹•å°‡æ’ç¨‹åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ç­†å·¥å–®ã€Œæ‹‰å…¥ã€ç”Ÿç”¢å€ä¸¦è¨­ç‚ºæº–å‚™ç‹€æ…‹ï¼Œæ¸›å°‘äººå·¥é¸å–®çš„æ“ä½œæ™‚é–“ã€‚
            </p>

            <h3>F10ï¼šé€€å›èˆ‡å–æ¶ˆ (Rollback)</h3>
            <p>
                è‹¥ä¸å°å¿ƒèª¤æŒ‰ F3 é–‹å§‹ç”Ÿç”¢ï¼Œæˆ–å› æ©Ÿå°æ•…éšœéœ€è¦æ›´æ›å·¥å–®ï¼Œè«‹æŒ‰ä¸‹ <strong>F10</strong>ã€‚
                ç³»çµ±æœƒå°‡ç›®å‰ã€Œç¶ è‰²ç”Ÿç”¢å€ã€çš„å·¥å–®å¼·åˆ¶<strong>é€€å›</strong>è‡³ä¸‹æ–¹çš„ã€Œé»ƒè‰²æ’ç¨‹å€ã€ï¼Œ
                ä½¿å…¶æ¢å¾©ç‚ºã€Œç­‰å¾…ä¸­ (Pending)ã€ç‹€æ…‹ï¼Œæ‚¨å³å¯å°å…¶é€²è¡Œåˆªé™¤æˆ–é‡æ–°æ’åºã€‚
            </p>
        </div>

        <h2>ä¸‰ã€ç‡ˆè™Ÿèˆ‡ç•°å¸¸æ’é™¤</h2>

        <h3>1. è»Šé€Ÿç‡ˆè™Ÿ</h3>
        <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 10px;">
                <span class="status-indicator status-red"><span class="color-dot red"></span> ç´…è‰² (åæ…¢)</span>
                <span style="margin-left: 10px;">æ©Ÿå°é€Ÿåº¦ä½æ–¼æ¨™æº–ã€‚è«‹æª¢æŸ¥æ˜¯å¦æœ‰å¡ç´™æˆ–æ©Ÿå°ç•°å¸¸ã€‚</span>
            </li>
            <li style="margin-bottom: 10px;">
                <span class="status-indicator status-yellow"><span class="color-dot yellow"></span> é»ƒè‰² (æ­£å¸¸)</span>
                <span style="margin-left: 10px;">æ©Ÿå°é‹è½‰ä¸­ï¼Œé€Ÿåº¦ä»‹æ–¼æ¨™æº–ç¯„åœã€‚</span>
            </li>
            <li>
                <span class="status-indicator status-green"><span class="color-dot green"></span> ç¶ è‰² (é«˜é€Ÿ)</span>
                <span style="margin-left: 10px;">æ©Ÿå°é”åˆ°æ¥µä½³ç”Ÿç”¢æ•ˆç‡ã€‚</span>
            </li>
        </ul>

        <h3>2. æº–å‚™æ™‚é–“ (æ›å–®æ•ˆç‡)</h3>
        <p>ç•«é¢ä¸­å¤®çš„ç¶ è‰²æ¡†æ¡†æœƒæ ¹æ“šæ‚¨çš„æ›å–®é€Ÿåº¦è®Šè‰²ï¼š</p>
        <div class="note">
            <ul>
                <li><strong>ğŸŸ¢ ç¶ æ¡†</strong>: æ›å–®å¾ˆå¿«ï¼åœ¨æ¨™æº–æ™‚é–“å…§å®Œæˆã€‚</li>
                <li><strong>ğŸŸ¡ é»ƒæ¡†</strong>: é‚„å¯ä»¥ï¼Œç¨å¾®è¶…å‡ºé è¨ˆæ™‚é–“ã€‚</li>
                <li><strong>ğŸ”´ ç´…æ¡†</strong>: æ›å–®éä¹…ã€‚è«‹ç¢ºèªæ˜¯å¦è¦å›å ±ã€Œåœæ©ŸåŸå› ã€ã€‚</li>
            </ul>
        </div>

        <h3>3. åœè»ŠåŸå› ç™»éŒ„ (Stop Reason)</h3>
        <p>ç•¶æ©Ÿå°åœæ©Ÿè¶…é 3 åˆ†é˜ï¼ˆç³»çµ±å¯è¨­å®šï¼‰ï¼Œç³»çµ±æœƒè·³å‡º <strong>ã€Œåœæ©ŸåŸå› é¸æ“‡ã€</strong> è¦–çª—ã€‚</p>
        <ol class="step-list">
            <li>è‹¥æœªè‡ªå‹•è·³å‡ºï¼Œå¯æ‰‹å‹•é»æ“Š F8ã€‚</li>
            <li>é¸æ“‡é¡åˆ¥ï¼ˆå¦‚ï¼šå¾…æ–™ã€æ©Ÿæ¢°æ•…éšœã€æ›ç‰ˆã€åƒé£¯ï¼‰ã€‚</li>
            <li>ç¢ºèªå¾Œï¼Œè©²æ®µåœæ©Ÿæ™‚é–“æœƒè¢«æ­¸é¡çµ±è¨ˆï¼Œç”¨æ–¼è¨ˆç®—ç¨¼å‹•ç‡ (OEE)ã€‚</li>
        </ol>

        <h2>å››ã€æ©Ÿå°é€£ç·šæ•…éšœæ’é™¤ SOP (Troubleshooting)</h2>
        <p>ç•¶ç›£æ§ç•«é¢æ•¸æ“šä¸è·³å‹•ï¼Œæˆ–å³ä¸Šè§’é¡¯ç¤º <strong>ã€Œæ–·ç·š (Disconnected)ã€</strong> æ™‚ï¼Œè«‹ä¾åºæª¢æŸ¥ï¼š</p>

        <div class="warning">
            <h3>æ­¥é©Ÿ 1: æª¢æŸ¥ PLC ç‹€æ…‹</h3>
            <ul>
                <li>ç¢ºèªæ©Ÿå° PLC é›»æºæ˜¯å¦é–‹å•Ÿã€‚</li>
                <li>ç¢ºèª PLC ç¶²è·¯ç·šæ’å­”ç‡ˆè™Ÿæ˜¯å¦æ†äº®æˆ–é–ƒçˆï¼ˆæ©˜/ç¶ ç‡ˆï¼‰ã€‚</li>
            </ul>

            <h3>æ­¥é©Ÿ 2: æª¢æŸ¥ç¶²è·¯é€£ç·š</h3>
            <ul>
                <li>ç¢ºèªå·¥å» å…§ç¶² (Wi-Fi/LAN) æ˜¯å¦æ­£å¸¸ã€‚</li>
                <li>å˜—è©¦åœ¨ç€è¦½å™¨é‡æ–°æ•´ç†é é¢ (F5)ã€‚</li>
            </ul>

            <h3>æ­¥é©Ÿ 3: æª¢æŸ¥å¾Œç«¯æœå‹™ (Backend Worker)</h3>
            <ul>
                <li>è‹¥é é¢å¯é–‹å•Ÿä½†æ•¸æ“šçš†ç‚º 0ï¼š
                    <ol>
                        <li>è¯ç¹« IT äººå“¡æˆ–é€é Admin æ¬Šé™é€²å…¥ Docker ç®¡ç†ä»‹é¢ã€‚</li>
                        <li>æª¢æŸ¥ <code>backend-worker</code> å®¹å™¨æ˜¯å¦åŸ·è¡Œä¸­ã€‚</li>
                        <li>æŸ¥çœ‹æ—¥èªŒï¼šç¢ºèªæ˜¯å¦æœ‰ <code>MQTT Connection Failed</code> æˆ– <code>Modbus Timeout</code> éŒ¯èª¤ã€‚</li>
                    </ol>
                </li>
            </ul>

            <h3>æ­¥é©Ÿ 4: ç³»çµ±é‡å•Ÿ (æœ€å¾Œæ‰‹æ®µ)</h3>
            <p>è‹¥ä¸Šè¿°ç„¡æ•ˆï¼Œè«‹ä¾åºé‡å•Ÿï¼š</p>
            <ol>
                <li>é—œé–‰ç€è¦½å™¨åˆ†é ã€‚</li>
                <li>é‡å•Ÿå·¥æ§é›»è…¦ (IPC)ã€‚</li>
                <li>å¾…é›»è…¦é–‹æ©Ÿå®Œæˆå¾Œï¼Œé‡æ–°åŸ·è¡Œ Desktop ä¸Šçš„ <strong>"Start Flexo System"</strong> æ·å¾‘ã€‚</li>
            </ol>
        </div>

        <h2>äº”ã€æ¯æ—¥å·¡æª¢èˆ‡ç¢ºèª (Daily Inspection)</h2>
        <p>ç‚ºç¢ºä¿ç³»çµ±é‹ä½œæ­£å¸¸ï¼Œè«‹æ–¼æ¯æ—¥é–‹æ©Ÿæˆ–æ›ç­æ™‚åŸ·è¡Œä»¥ä¸‹æª¢æŸ¥ï¼š</p>

        <div class="note" style="border-left-color: #2e7d32; background: #e8f5e9;">
            <h3>1. æ•¸æ“šç©©å®šæ€§æª¢æŸ¥ (Data Stability)</h3>
            <p><strong>æƒ…å¢ƒ</strong>ï¼šæ©Ÿå°é‹è½‰ä¸­ï¼Œè»Šé€Ÿé¡¯ç¤ºå¿½å¿«å¿½æ…¢ï¼Ÿ</p>
            <ul>
                <li>è§€å¯Ÿè»Šé€Ÿé¡¯ç¤ºæ˜¯å¦ç©©å®šï¼ˆå…è¨± Â±5 m/min è·³å‹•ï¼‰ã€‚</li>
                <li>è‹¥æ•¸å€¼ç˜‹ç‹‚è·³å‹•ï¼ˆå¦‚ 0 -> 200 -> 0ï¼‰ï¼Œè«‹å‘é ˜ç­å›å ±ã€Œè¨Šè™Ÿå¹²æ“¾ã€ã€‚</li>
            </ul>
        </div>

        <div class="note" style="border-left-color: #1565c0; background: #e3f2fd;">
            <h3>2. è‡ªå‹•æ­¸é›¶ç¢ºèª (Zero Count Check)</h3>
            <p><strong>æƒ…å¢ƒ</strong>ï¼šé–‹å§‹æ–°å·¥å–®æ™‚ï¼Œæ•¸é‡ä¸æ˜¯ 0ï¼Ÿ</p>
            <ul>
                <li>ç¢ºèªæ¯æ¬¡æŒ‰ä¸‹ <strong>F3 é–‹å§‹ç”Ÿç”¢</strong> æ™‚ï¼Œä¸­é–“ç¶ è‰²ç”Ÿç”¢å€çš„ã€Œç”Ÿç”¢æ•¸é‡ã€æ˜¯å¦å¾ <strong>0</strong> é–‹å§‹ç´¯è¨ˆã€‚</li>
                <li>ç³»çµ±æ‡‰è‡ªå‹•æ‰£é™¤æ©Ÿå°ç›®å‰çš„ç´¯è¨ˆå€¼ (Auto-Tare)ã€‚è‹¥æœªæ­¸é›¶ï¼Œè«‹ä½¿ç”¨ F10 é€€å›å¾Œé‡è©¦ã€‚</li>
            </ul>
        </div>


        <!-- Admin Only Technical Section (SASD Perspective) -->
        <div id="admin-section"
            style="display: none; border-top: 3px dashed #bbdefb; margin-top: 50px; padding-top: 30px;">
            <h2 style="color: #d32f2f; border-left-color: #d32f2f;">ğŸ› ï¸ ç³»çµ±æ¶æ§‹èˆ‡æŠ€è¡“èªªæ˜ (System Architecture - SASD)</h2>
            <div class="warning" style="background: #fff3e0; border-left-color: #ef6c00;">
                æ­¤å€åŸŸåƒ…é¡¯ç¤ºçµ¦ <strong>Admin</strong> æ¬Šé™ä½¿ç”¨è€…ã€‚æœ¬ç¯€å…§å®¹åŸºæ–¼ SASD è¦æ ¼æ›¸æ’°å¯«ã€‚
            </div>

            <h3>1. ç³»çµ±æ¶æ§‹æ¦‚è§€ (System Architecture)</h3>
            <p>æœ¬ç³»çµ±æ¡ç”¨ <strong>å‰å¾Œç«¯åˆ†é›¢</strong> èˆ‡ <strong>é›™è»Œåˆ¶è³‡æ–™æµ (Dual-Path)</strong> è¨­è¨ˆï¼š</p>
            <ul class="step-list">
                <li><strong>Frontend</strong>: React (Vite), è² è²¬ UI å‘ˆç¾èˆ‡ Simulated MQTT ç™¼é€ã€‚</li>
                <li><strong>Backend</strong>: .NET 8 (Worker Service + API), è² è²¬ MQTT è¨‚é–±ã€è™•é‚è¼¯é‹ç®— (è»Šé€Ÿ/è¨ˆç±³) èˆ‡ Redis å¿«å–ã€‚</li>
                <li><strong>Infrastructure</strong>: Redis (Cache), PostgreSQL (DB), MQTT Broker (Mosquitto).</li>
            </ul>

            <h3>2. è³‡æ–™æµå‘ (Data Flow Diagram)</h3>
            <div
                style="display: flex; gap: 20px; align-items: center; justify-content: center; margin: 30px 0; font-size: 0.9rem;">
                <div style="text-align: center;">
                    <div style="background: #e3f2fd; padding: 15px; border: 2px solid #1976d2; border-radius: 8px;">
                        <strong>Device / Simulator</strong><br>Topic: Advantech/+/data
                    </div>
                </div>
                <div style="font-size: 20px;">â¡</div>
                <div style="text-align: center;">
                    <div style="background: #f3e5f5; padding: 15px; border: 2px solid #7b1fa2; border-radius: 8px;">
                        <strong>Backend Worker</strong><br>Device Locking & Calculation
                    </div>
                </div>
                <div style="font-size: 20px;">â¡</div>
                <div style="text-align: center;">
                    <div style="background: #e8f5e9; padding: 15px; border: 2px solid #2e7d32; border-radius: 8px;">
                        <strong>Redis Cache</strong><br>Key: factory/monitor
                    </div>
                </div>
                <div style="font-size: 20px;">â¡</div>
                <div style="text-align: center;">
                    <div style="background: #ffffff; padding: 15px; border: 2px solid #333; border-radius: 8px;">
                        <strong>Frontend UI</strong><br>GET /monitor/realtime
                    </div>
                </div>
            </div>

            <h3>3. æ ¸å¿ƒé‚è¼¯èªªæ˜ (Key Logic)</h3>

            <h4>A. è¨­å‚™é–å®šæ©Ÿåˆ¶ (Device Locking)</h4>
            <p>ç‚ºäº†è§£æ±ºå¤šè¨­å‚™/æ¨¡æ“¬å™¨åŒæ™‚ç™¼é€æ•¸æ“šé€ æˆçš„ Race Conditionï¼ŒBackend Worker å¯¦ä½œäº†ä»¥ä¸‹é–å®šç­–ç•¥ï¼š</p>
            <ul>
                <li><strong>å„ªå…ˆç´š (Priority)</strong>: ç¡¬é«”è¨­å‚™ MAC Address (12ç¢¼) > è»Ÿé«”æ¨¡æ“¬å™¨ (ORDER-MODE-XXX)ã€‚</li>
                <li><strong>é–å®š (Lock)</strong>: ä¸€æ—¦æ”¶åˆ°ç¡¬é«”è¨Šè™Ÿï¼Œç³»çµ±é–å®šè©² DeviceIDï¼Œç„¡è¦–å…¶ä»–è¨Šè™Ÿä¾†æºã€‚</li>
                <li><strong>è§£é– (Unlock)</strong>: ç¡¬é«”éœé»˜è¶…é 30 ç§’ (Timeout) è‡ªå‹•é‡‹æ”¾é–å®šã€‚</li>
            </ul>

            <h4>B. è»Šé€Ÿè¨ˆç®— (Speed Calculation)</h4>
            <p>ç”±æ–¼ PLC åƒ…å›å‚³ç´¯ç©æ•¸é‡ (DI1)ï¼Œç³»çµ±é€éå¾Œç«¯è¨ˆç®—å³æ™‚è»Šé€Ÿï¼š</p>
            <ul>
                <li><strong>å…¬å¼</strong>: <code>Speed = (CurrentQty - LastQty) / TimeDelta</code></li>
                <li><strong>å¹³æ»‘åŒ–</strong>: æ¡ç”¨ EMA (æŒ‡æ•¸ç§»å‹•å¹³å‡) æ¶ˆé™¤è¨Šè™ŸæŠ–å‹•ï¼ŒAlpha = 0.1ã€‚</li>
            </ul>

            <h3>4. API ä»‹é¢ (API References)</h3>
            <table class="fkey-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Endpoint</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="status-indicator status-green">GET</span></td>
                        <td><code>/monitor/realtime</code></td>
                        <td>å–å¾—å³æ™‚ç”Ÿç”¢æ•¸æ“š (Redis Cache)ã€‚</td>
                    </tr>
                    <tr>
                        <td><span class="status-indicator status-green">POST</span></td>
                        <td><code>/production/orders</code></td>
                        <td>å»ºç«‹æ–°å·¥å–®ã€‚</td>
                    </tr>
                    <tr>
                        <td><span class="status-indicator status-green">POST</span></td>
                        <td><code>/production/complete</code></td>
                        <td>å®Œå·¥çµç®— (å¯«å…¥ DB)ã€‚</td>
                    </tr>
                </tbody>
            </table>

        </div>

        <script>
            // Admin View Toggle Logic
            document.addEventListener('DOMContentLoaded', () => {
                try {
                    const userStr = localStorage.getItem('currentUser');
                    if (userStr) {
                        const user = JSON.parse(userStr);
                        // Check if role is ADMIN
                        if (user && user.role === 'ADMIN') {
                            const adminSection = document.getElementById('admin-section');
                            if (adminSection) {
                                adminSection.style.display = 'block';
                                console.log('Admin Access Detected: Showing Technical Documentation');
                            }
                        }
                    }
                } catch (e) {
                    console.error('Error checking user role:', e);
                }
            });
        </script>
</body>

</html>